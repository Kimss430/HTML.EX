<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리자 페이지</title>
    <link rel="stylesheet" href="css/admin-style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <style>
        /* 기존 CSS 스타일 유지 및 통합 */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        header {
            background-color: #f4f4f4;
            padding: 10px 0;
            text-align: center;
        }
        nav button {
            margin: 5px;
            padding: 10px 20px;
            border: none;
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }
        .section {
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        /* 사용자 목록 페이지 스타일 */
        #app {
            width: 100%;
            margin: 0 auto;
        }
        table {
            width: 600px;
        }
        table, tr, td, th {
            border: 1px solid;
            text-align: center;
            border-collapse: collapse;
        }
        tr, td, th {
            padding: 5px 10px;
        }
        td input {
            width: 70px;
        }
        .txt {
            font-weight: bold;
        }
        .txt2 {
            color: blue;
            font-weight: bold;
        }
        select {
            margin: 0 10px;
            padding: 2px;
        }
        .btn {
            margin-top: 5px;
            float: right;
        }
        input[type="radio"] {
            width: 20px;
        }
        .op {
            margin: 10px;
        }
    </style>
</head>
<body>
    <div id="app">
        <header>
            <h1>관리자 페이지</h1>
            <nav>
                <button @click="navigateTo('dashboard')">대시보드</button>
                <button @click="navigateTo('userManagement')">회원 관리</button>
                <button @click="navigateTo('orderManagement')">주문 관리</button>
                <button @click="navigateTo('qaManagement')">Q&A 관리</button>
                <button @click="navigateTo('userList')">사용자 목록</button>
            </nav>
        </header>

        <!-- 대시보드 섹션 -->
        <div v-if="currentSection === 'dashboard'" class="section">
            <h2>대시보드</h2>
            <p>관리자 대시보드입니다.</p>
        </div>

        <!-- 회원 관리 섹션 -->
        <div v-if="currentSection === 'userManagement'" class="section">
            <h2>회원 관리</h2>
            <input placeholder="검색어" v-model="keyword" @keyup.enter="fnGetList">
            <button @click="fnGetList">검색</button>
            <div style="margin-top: 20px;"></div>
            <select class="op" v-model="orderName" @change="fnGetList">
                <option value="USERNAME">이름</option>
                <option value="USER_ID">아이디</option>
                <option value="PHONE_NUMBER">전화번호</option>
            </select>
            <label><input type="radio" @change="fnGetList" v-model="orderKind" name="order" value="ASC">오름차순</label>
            <label><input type="radio" @change="fnGetList" v-model="orderKind" name="order" value="DESC">내림차순</label>
            <table>
                <thead>
                    <tr>
                        <th>선택</th>
                        <th>아이디</th>
                        <th>이름</th>
                        <th>메일</th>
                        <th>전화번호</th>
                        <th>성별</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(item, index) in list" :key="item.USER_ID">
                        <td><input type="radio" :id="'user-' + index" name="userKey" :value="item.USER_ID" v-model="selectItem"></td>
                        <td><label :for="'user-' + index">{{ item.USER_ID }}</label></td>
                        <td><a href="javascript:;" @click="fnInfo(item.USER_ID)">{{ item.USERNAME }}</a></td>
                        <td>{{ item.EMAIL }}</td>
                        <td>{{ item.PHONE_NUMBER }}</td>
                        <td>
                            <span v-if="item.GENDER === 'M'">남자</span>
                            <span v-else>여자</span>
                        </td>
                    </tr>
                </tbody>
            </table>
            <button @click="fnSave" class="btn">저장</button>
            <button @click="fnRemove" class="btn">삭제</button>
        </div>

        <!-- 주문 관리 섹션 -->
        <div v-if="currentSection === 'orderManagement'" class="section">
            <h2>주문 관리</h2>
            <!-- 주문 관리 내용 추가 -->
        </div>

        <!-- Q&A 관리 섹션 -->
        <div v-if="currentSection === 'qaManagement'" class="section">
            <h2>Q&A 관리</h2>
            <!-- Q&A 관리 내용 추가 -->
        </div>

        <!-- 사용자 목록 섹션 -->
        <div v-if="currentSection === 'userList'" class="section">
            <!-- 사용자 목록 페이지 내용 추가 -->
        </div>
    </div>

    <script>
        const app = Vue.createApp({
            data() {
                return {
                    currentSection: 'dashboard',
                    list: [],
                    keyword: "",
                    selectItem: "",
                    orderName: "USERNAME",
                    orderKind: "ASC"
                };
            },
            methods: {
                navigateTo(section) {
                    this.currentSection = section;
                    if (section === 'userManagement') {
                        this.fnGetList();
                    }
                },
                fnGetList() {
                    const url = `http://localhost:3000/list?keyword=${this.keyword}&orderName=${this.orderName}&orderKind=${this.orderKind}`;
                    $.ajax({
                        url: url,
                        dataType: "json",
                        type: "GET",
                        success: (data) => {
                            this.list = data;
                        },
                        error: (error) => {
                            console.error('Error fetching list:', error);
                        }
                    });
                },
                fnSave() {
                    if (!confirm("저장 하시겠습니까?")) return;
                    const url = `http://localhost:3000/update?id=${this.selectItem}`;
                    $.ajax({
                        url: url,
                        dataType: "json",
                        type: "GET",
                        success: (data) => {
                            alert(data[0].message);
                            this.fnGetList();
                        },
                        error: (error) => {
                            console.error('Error saving data:', error);
                        }
                    });
                },
                fnRemove() {
                    if (!confirm("정말 삭제하시겠습니까?")) return;
                    const url = `http://localhost:3000/delete?id=${this.selectItem}`;
                    $.ajax({
                        url: url,
                        dataType: "json",
                        type: "GET",
                        success: (data) => {
                            alert(data[0].message);
                            this.fnGetList();
                        },
                        error: (error) => {
                            console.error('Error removing data:', error);
                        }
                    });
                },
                fnInfo(id) {
                    location.href = `info.html?id=${id}`;
                }
            },
            mounted() {
                this.fnGetList(); // 초기 로드 시 사용자 목록을 가져옵니다.
            }
        });

        app.mount('#app');
    </script>
</body>
</html>